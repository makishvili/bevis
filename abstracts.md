**Вадим:**

* Приветствие

* Рассказать о Марате

**Марат:**

* Бивис - для большого сайта

* Другие решения слоные, наше простое даже для школьника


**Вадим:**

* У нас нет целей. Мы просто делимся


**Вадим:**

* Обычное MVC-приложение

* Бивис-приложение

* Что внутри контроллера, Марат?

**Марат:**

* Обычный `javascript`. Объект `pages`, метод `declare`, два компонента. Это обычный `JSON`.

* Вадим, ты скучаешь по html-тегам?

**Вадим:**

* Нет, не скучаю.

* Картина вблизи

* Эскиз от дизйнера

* Мы смотрим на эскиз абстрактными модулями

* Термин "блоки", Харисов.


* Бивис-блок - простая декларация на JSON. Чем предмет проще, тем легче им пользоваться. Тем больше удовольствия от использования.

* Бабушка и хлебопечка.


* Мы с Маратом - пожилые. И ребята в команде - немолодые. Теги и атрибуты - сложно. Много суеты, мало смысла.


* Простое опсиание страницы --> сложный HTML

* Одного имени достаточно


* Марат в гости. Я не хочу думать об устройстве блока и его детях.

* Солянка со сметаной. Дополнительный параметр.

* Петренко на правый фланг.  Блок сам решает, как выполнить задачу.

**Марат:**

* Создавать страницы - просто.

* Создавать блоки - просто.

* Строение - три части.

* Вадим, расскажи про HTML-структуру.


**Вадим:**

* Императивные шаблоны в PHP

* Декларативные шаблоны - как в XSLT и в CSS


* Как работает селектор


* Пишем шаблон. Какой JSON, какой меташаблон, какой bt-шаблон

* Марат, покажи, как написать полноценный шаблон.

**Марат:**


* Добавляем в шаблон элемент

* Пишем шаблон для элемента

* Какой html получили


* Реальный пример Яндекс-шапки.

* Обязательное поле — имя блока.

* Так это выглядит в браузере

**Вадим:**

* Оверхед? Почему не понятные императивные шаблоны?

**Марат:**

* Императивные шаблоны понятные, пока их немного.

* BT-шаблоны позволяют сохранять сложность на одном уровне.

* BT-шаблоны позволяют иметь явный и понятный API:

  * простая декларация шапки может стать сложным html-кодом

  * можно менять шаблон, не меняя страницы и другие блоки.


* Бивис реализует идею Web Components.


* Вадим, расскажи про представление в бивис-блоках.

**Вадим:**

* Простое имя — Марат, Вадим, header.

* Точное имя — Марат Дулин, или Вадим Макишвили. Чтобы добавить в имя уникальности.


* Кого из вас зовут Вадим? 404 в проде.

* Жизнь доказывает, имени и фамилии достаточно.


* 'header' - имя, `view` - фамилия

```javascript
{
    block: 'header',
    view: 'search'
}
```


* Читать это так:

```html
<div class="header_search">
    ....
</div>
```


* В проекте шапка одна, в разных видах, поисковая и непоисковая. Два скина... вью



* Важное заявление! Имя может быть только одно

```
<div class="header authorization"></div>
```


* Я и папа, я и мама? Мимино.

* Хороший летчик не может быть одновременно хорошим эндокринологом - проблемы!


* В `CSS` нет надёжного механизма разруливания весов стилевых селекторов с одинаковой специфичностью.


* В `BEViS` нет смешивания - нет конфликтов.

**Марат:**

* Часто в Яндексе пишут так - базовый класс и модифицирующие классы

```html
<div class="button button_theme_normal button_shadow_yes">кнопка</div>
```


* Чем это опасно? Нет гарантии, что не возникнет конликт весов на ДОМ-ноде


* В большом проекте нужно тестировать проект после изменения в одном классе.

* И это совсем не похоже на независимые блоки.



* В Бивисе одна нода - один блок. Если в проекте нужна такая же кнопка, нужен отдельный класс.

```html
<div class="button_normal-shadow">кнопка</div>
```


**Вадим:**

* А как мне отобразить эту же кнопку, но в нажатом состянии? Ещё один вью писать?

**Марат:**

* Нет, есть состояния, давай расскажем о них позже.

* А сейчас расскажи, как мы используем препроцессор.


**Вадим:**

* Кто не знает, что такое препроцессор? Все знают. Кроме меня. Брезгливо. Сахар.


* Не ради сахара. Ради гибкости.

```css
skin-common() {
    /* общие стили для кнопки */
}

skin-theme-normal() {
    /* цветовая тема */
}

skin-shadow() {
    /* стили добавляют тень */
}

.button {
    skin-common()
    skin-theme-normal()
}

.button_normal-shadow {
    skin-common();
    skin-theme-normal();
    skin-shadow();
}
```


* Скины - примеси, те же функции.


* Два вида кнопки зовут нужные примеси. Конфликты правим здесь же.

* В браузер — один css-селектор. Гарантированно работающий.


* Спаисбо Комарову.

Марат, расскажи, как мы пишем js?

**Марат:**

* В маленьких проектах.

```javascript
$( document ).ready(function() {

    var form = $('#my-form');
    form.submit(onSubmited);

    function onSubmited() {
        if ($('#my-form .button').hasClass('disabled')) {
            return false;
        }
    }

});
```


* В бивисе не ```$( document ).ready()```, а модули.

```javascript
modules.define(
    'form',
    ['jquery'],
    function(provide, $) {

        var form = $('#my-form');
        form.submit(onSubmited);

        function onSubmited() {
            if ($('#my-form .button').hasClass('disabled')) {
                return false;
            }
        }

        provide(form);
    }
);
```

* Код тот же, обвязка поменялась. Модуль - это...

**Вадим:** А внутри модулей мы используем голый jQuery?

**Марат:**

* Не используем напрямую JQuery. Свой базовый класс для абстракции над DOM-деревом.

```javascript
modules.define(
    'form',
    ['button', 'input', 'y-block'],
    function(provide, button, input, YBlock) {

        var Form = inherit(YBlock, {
            __constructor: function () {
                this._submitButton = YButton.find(this);
                this._bindTo(this.getDomNode(), 'submit', this._onSubmited);

            },

            _onSubmited: function (e) {
                if (this._submitButton.isDisabled()) {
                    e.preventDefault();
                } else {
                    this.emit('submit');
                }
            }
        });

        provide(Form);
    }
);
```

**Вадим:** Почему не просто jQuery?

**Марат:**

1. Этот код можно реиспользовать.

2. HTML-структурой блока не важна.

3. Мы смотрим на блоки с точки зрения семантики их работы.

**Вадим:**

4. Мы максимально отделили визуальное отображение и поведение.

```html
<div
    class="header"
    data-block="header">
</div>
```

* class - для стилей, дата-атрибут - для поведения.


* Есть место, где поведение и отображение пересекаются. Неизбежно. И в жизни так

  * когда я бегаю по стадиону

  * когда я плаваю долго в море


* В блоке тоже самое. Валидация формы


* Из `js` мы добавляем css-класс

```html
<input class="login _unfilled" type="text"/>
```


* и подготовим стили:

```css
/* обычное состояние */
.login {
    ...
}

/* тревожное состояние */
.login._unfilled {
    border: 1px solid red;
}
```


* Эти классы - состояния — State. Почему начинается с подчёркивания? Приватный и заметный.

```
B — [B]lock
E — [E]lement
Vi— [Vi]ew
S — [S]tate
```


* Мы почти закончили. Марат, расскажи, как блок представлен на файловой системе.

**Марат:**

* Не пишем страничные стили в одном файле, все шаблоны в одном файле, весь клиентский js в одном файле.

* Страничные файлы создаются автоматически из блочных файлов. Один блок - одна папка. Это по-человечески.


* У меня есть дом. И у блока есть дом — `/blocks`. Если здесь нет, больше нигде нет.

````
/blocks
    /header
        header.bt.js
        header.styl
        header.js
    /form
        form.bt.js
        form.styl
        form.js
````


* шаблоны в `bt.js`,

* стили в `styl`,

* клиентский яваскрипт в `js`.

**Вадим:**

* Это не рокет-сайнс. Дочка перед математикой.

* Учительница ходит по рядам и забирает тетради в стопку. И у нас есть сборщик для html, css, и js.


* Марат, зачем ты написал ENB, а не взяли Ant, Make, Grunt?


**Марат:**

* Огромная скорость сборки для проектов с блочной структурой.

* Встроенный сервер.

* Сборка часто узкое место, но в BEViS достаточно лишь обновлять страницу в браузере.

**Вадим:** А ещё у сборщика Марата очень понятная документация и конфигуратор для школьника.


## Заключение

**Вадим:**

* Документация для бивиса

* Начать работать просто:

```
git clone git@github.com:bevis-ui/bevis-stub.git your-project
cd your-project
make
```


**Марат:**

* TodoMVC на Бивисе. Для примера.


**Вадим:**

* бивис - обычный javascript.

* покрыт юнит-тестами.

* написан в очень понятном кодстайле команды Яндекс.Карт.


* Мы не просим контрибьюторами.

* бивис-подход жизнеспособный, доказали на нескольких проектах.


* Верстать homepage на бивисе — экскаватором лунку. Но если нужно перекопать большое поле — бивис и для вас тоже.

**Марат:**

* С вами была команда Яндекс.Карт и её представители на этой конференции - Вадим Макишвили и Марат Дулин.

* Спасибо большое!
